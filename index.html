<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF to Image Converter</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f0f0f;
  color:white;
  text-align:center;
}

.container{
  max-width:500px;
  margin:auto;
  padding:20px;
}

.card{
  background:#1c1c1c;
  padding:20px;
  border-radius:15px;
  margin-bottom:20px;
  box-shadow:0 0 25px rgba(0,0,0,0.7);
}

h2{
  margin-bottom:20px;
}

input[type="file"]{
  width:100%;
  margin-bottom:15px;
  color:white;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:linear-gradient(45deg,#222,#444);
  color:white;
  font-size:16px;
  cursor:pointer;
  transition:0.3s;
}

button:hover{
  background:linear-gradient(45deg,#333,#666);
}

canvas{
  width:100%;
  margin-top:15px;
  border-radius:10px;
  background:#111;
}

.download-link{
  display:block;
  margin:10px 0;
  color:#4da6ff;
  text-decoration:none;
  font-weight:bold;
}

</style>
</head>

<body>

<div class="container">

<h2>PDF to Image Converter</h2>

<div class="card">
<input type="file" id="pdfFile" accept="application/pdf">
<button onclick="convertPDF()">Convert to Images</button>
</div>

<div class="card" id="output">
<p>Converted pages will appear here</p>
</div>

</div>

<script>

// Register Service Worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

async function convertPDF(){

    const file = document.getElementById('pdfFile').files[0];
    if(!file){
        alert("Please select a PDF file first");
        return;
    }

    const reader = new FileReader();
    reader.readAsArrayBuffer(file);

    reader.onload = async function(){

        const typedarray = new Uint8Array(this.result);
        const pdf = await pdfjsLib.getDocument(typedarray).promise;

        const output = document.getElementById("output");
        output.innerHTML = "";

        for(let pageNum = 1; pageNum <= pdf.numPages; pageNum++){

            const page = await pdf.getPage(pageNum);
            const viewport = page.getViewport({ scale: 2 });

            const canvas = document.createElement("canvas");
            const context = canvas.getContext("2d");

            canvas.height = viewport.height;
            canvas.width = viewport.width;

            await page.render({
                canvasContext: context,
                viewport: viewport
            }).promise;

            output.appendChild(canvas);

            const link = document.createElement("a");
            link.className = "download-link";
            link.innerText = "Download Page " + pageNum;
            link.href = canvas.toDataURL("image/png");
            link.download = "page_" + pageNum + ".png";
            output.appendChild(link);
        }
    }
}

</script>

</body>
</html>
